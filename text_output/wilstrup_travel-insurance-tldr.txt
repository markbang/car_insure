![image.png](data:image/png;base64,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)

In the TLDR (Too Long; didn't read) notebooks, I don't try to do any fancy
feature engineering, data cleaning, n-fold validation, or similar time
consuming techniques. I simply solve the problem in six staightforward steps:

  1. Load the data
  2. Split in train and test sets
  3. Determine in input features are categorical or continuous
  4. Connect to a QLattice and reset it
  5. Use QLattice to find the simples possible model
  6. Evaluate the model (with AUC for classification and $R^2$ for regression)

In [1]:

    
    
    !pip install feyn
    
    
    
    Collecting feyn
    
      Downloading feyn-2.1.0-cp37-cp37m-manylinux2014_x86_64.whl (313 kB)
    
         |ââââââââââââââââââââââââââââââââ| 313 kB 4.4 MB/s 
    
    Requirement already satisfied: requests in /opt/conda/lib/python3.7/site-packages (from feyn) (2.25.1)
    
    Requirement already satisfied: urllib3>=1.26 in /opt/conda/lib/python3.7/site-packages (from feyn) (1.26.5)
    
    Requirement already satisfied: ipython in /opt/conda/lib/python3.7/site-packages (from feyn) (7.24.1)
    
    Requirement already satisfied: matplotlib in /opt/conda/lib/python3.7/site-packages (from feyn) (3.4.2)
    
    Requirement already satisfied: pandas in /opt/conda/lib/python3.7/site-packages (from feyn) (1.2.4)
    
    Collecting svgwrite
    
      Downloading svgwrite-1.4.1-py3-none-any.whl (66 kB)
    
         |ââââââââââââââââââââââââââââââââ| 66 kB 3.5 MB/s 
    
    Collecting lark
    
      Downloading lark-0.11.3.tar.gz (229 kB)
    
         |ââââââââââââââââââââââââââââââââ| 229 kB 41.4 MB/s 
    
    Requirement already satisfied: numpy>=1.18 in /opt/conda/lib/python3.7/site-packages (from feyn) (1.19.5)
    
    Requirement already satisfied: pickleshare in /opt/conda/lib/python3.7/site-packages (from ipython->feyn) (0.7.5)
    
    Requirement already satisfied: jedi>=0.16 in /opt/conda/lib/python3.7/site-packages (from ipython->feyn) (0.18.0)
    
    Requirement already satisfied: prompt-toolkit!=3.0.0,!=3.0.1,<3.1.0,>=2.0.0 in /opt/conda/lib/python3.7/site-packages (from ipython->feyn) (3.0.19)
    
    Requirement already satisfied: traitlets>=4.2 in /opt/conda/lib/python3.7/site-packages (from ipython->feyn) (5.0.5)
    
    Requirement already satisfied: setuptools>=18.5 in /opt/conda/lib/python3.7/site-packages (from ipython->feyn) (49.6.0.post20210108)
    
    Requirement already satisfied: backcall in /opt/conda/lib/python3.7/site-packages (from ipython->feyn) (0.2.0)
    
    Requirement already satisfied: decorator in /opt/conda/lib/python3.7/site-packages (from ipython->feyn) (5.0.9)
    
    Requirement already satisfied: pexpect>4.3 in /opt/conda/lib/python3.7/site-packages (from ipython->feyn) (4.8.0)
    
    Requirement already satisfied: matplotlib-inline in /opt/conda/lib/python3.7/site-packages (from ipython->feyn) (0.1.2)
    
    Requirement already satisfied: pygments in /opt/conda/lib/python3.7/site-packages (from ipython->feyn) (2.9.0)
    
    Requirement already satisfied: parso<0.9.0,>=0.8.0 in /opt/conda/lib/python3.7/site-packages (from jedi>=0.16->ipython->feyn) (0.8.2)
    
    Requirement already satisfied: ptyprocess>=0.5 in /opt/conda/lib/python3.7/site-packages (from pexpect>4.3->ipython->feyn) (0.7.0)
    
    Requirement already satisfied: wcwidth in /opt/conda/lib/python3.7/site-packages (from prompt-toolkit!=3.0.0,!=3.0.1,<3.1.0,>=2.0.0->ipython->feyn) (0.2.5)
    
    Requirement already satisfied: ipython-genutils in /opt/conda/lib/python3.7/site-packages (from traitlets>=4.2->ipython->feyn) (0.2.0)
    
    Requirement already satisfied: python-dateutil>=2.7 in /opt/conda/lib/python3.7/site-packages (from matplotlib->feyn) (2.8.1)
    
    Requirement already satisfied: pyparsing>=2.2.1 in /opt/conda/lib/python3.7/site-packages (from matplotlib->feyn) (2.4.7)
    
    Requirement already satisfied: cycler>=0.10 in /opt/conda/lib/python3.7/site-packages (from matplotlib->feyn) (0.10.0)
    
    Requirement already satisfied: kiwisolver>=1.0.1 in /opt/conda/lib/python3.7/site-packages (from matplotlib->feyn) (1.3.1)
    
    Requirement already satisfied: pillow>=6.2.0 in /opt/conda/lib/python3.7/site-packages (from matplotlib->feyn) (8.2.0)
    
    Requirement already satisfied: six in /opt/conda/lib/python3.7/site-packages (from cycler>=0.10->matplotlib->feyn) (1.15.0)
    
    Requirement already satisfied: pytz>=2017.3 in /opt/conda/lib/python3.7/site-packages (from pandas->feyn) (2021.1)
    
    Requirement already satisfied: chardet<5,>=3.0.2 in /opt/conda/lib/python3.7/site-packages (from requests->feyn) (4.0.0)
    
    Requirement already satisfied: idna<3,>=2.5 in /opt/conda/lib/python3.7/site-packages (from requests->feyn) (2.10)
    
    Requirement already satisfied: certifi>=2017.4.17 in /opt/conda/lib/python3.7/site-packages (from requests->feyn) (2021.5.30)
    
    Building wheels for collected packages: lark
    
      Building wheel for lark (setup.py) ... - \ done
    
      Created wheel for lark: filename=lark-0.11.3-py2.py3-none-any.whl size=99635 sha256=546d312e9924deb63125f6cc05add48c55eac467990404d6e929a067614bae96
    
      Stored in directory: /root/.cache/pip/wheels/d7/61/3c/9ac365f55966367be8d77dbeb21a3ddece3c466e660121e8d6
    
    Successfully built lark
    
    Installing collected packages: svgwrite, lark, feyn
    
    Successfully installed feyn-2.1.0 lark-0.11.3 svgwrite-1.4.1
    
    WARNING: Running pip as root will break packages and permissions. You should install packages reliably by using venv: https://pip.pypa.io/warnings/venv
    
    

# 1\. Load the data¶

In [2]:

    
    
    import feyn
    import pandas as pd
    df = pd.read_csv("/kaggle/input/travel-insurance-prediction-data/TravelInsurancePrediction.csv")
    df.drop(["Unnamed: 0"], axis=1, inplace=True)
    

# 2\. Split in train and test¶

In [3]:

    
    
    train, test = feyn.tools.split(df, ratio=(2,1), random_state=42)
    

# 3\. Identify categorical features¶

In [4]:

    
    
    stypes = {name: "cat" for name in df if df[name].dtype=="object"}
    

# 4\. Connect to QLattice an reset¶

In [5]:

    
    
    ql = feyn.connect_qlattice()
    ql.reset(random_seed=42)
    
    
    
    A new Community QLattice has been allocated for you. This temporary QLattice is available for personal/non-commercial use. By using this Community QLattice you agree to the terms and conditions which can be found at `https://abzu.ai/privacy`.
    

# 5\. Find best model¶

In [6]:

    
    
    models = ql.auto_run(train, output_name="TravelInsurance", kind="classification", stypes=stypes, n_epochs=20)
    

Loss: 4.89E-01Epoch no. 20/20 - Tried 37574 models - Completed in 2m
32s.TravelInsurance logistic: w=-3.6281
bias=1.7685TravelIn..0outgaussian2gaussian1multiplymultiply2EverTravelledAbroad
categorical with 2 values bias=-0.3043EverTrav..3catAnnualIncome linear:
scale=0.000001 w=-1.877647
bias=1.5959AnnualIn..4nummultiplymultiply5Employment Type categorical with 2
values bias=-0.6571Employme..6catmultiplymultiply7Age linear: scale=0.200000
w=-0.568461 bias=3.2418Age8numFamilyMembers linear: scale=0.285714 w=-1.289292
bias=0.8302FamilyMe..9num

# 6\. Evaluate with AUC¶

In [7]:

    
    
    models[0].plot_roc_curve(train, label="train")
    models[0].plot_roc_curve(test, label="test")
    

![](__results___files/__results___13_0.png)

![](__results___files/__results___13_1.png)

# THE END¶

